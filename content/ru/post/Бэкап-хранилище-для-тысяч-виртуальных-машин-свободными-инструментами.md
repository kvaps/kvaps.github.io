---
title: "Бэкап-хранилище для тысяч виртуальных машин свободными инструментами"
date: 2020-05-28 00:39:00
link: https://habr.com/ru/post/504152/
---

![](https://hsto.org/webt/br/qy/_z/brqy_zs-d0ewx13ouawskifpqio.png)

Привет, недавно мне попалась интересная задачка настроить хранилище для бэкапа большого количества блочных устройств.

Каждую неделю мы выполняем резервное копирование всех виртуальных машин в нашем облаке, таким образом нужно уметь обслуживать тысячи резервных копий и делать это максимально быстро и эфективно.

К сожалению стандартные конфигурации **RAID5**, **RAID6** в данном случае нам не подхотят в виду того что процесс восстановления на таких больших дисках как наши будет мучительно долгим и скорее всего не закончится никогда.

Рассмотрим какие есть альтернативы :

**[Erasure Coding](https://docs.min.io/docs/minio-erasure-code-quickstart-guide.html)** - Аналог RAID5, RAID6, но с настраиваемым уровнем четности. При этом резервирование выполняется не поблочно а для каждого объекта отдельно. Наиболее простой способ попробовать erasure coding - это развернуть [minio](https://min.io/).

**[DRAID](https://openzfs.github.io/openzfs-docs/Basic%20Concepts/dRAID%20Howto.html)** - это на данный момент ещё не выпущенная возможность ZFS. В отличие от RAIDZ DRAID имеет распределённый parity block и при восстановлении задействует сразу все диски массива, благодаря чему лучше переживает отказы дисков и быстрее восстанавливается после сбоя. 

<!--more-->
